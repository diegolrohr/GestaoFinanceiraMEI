<script>
    @Html.Partial("Functions/_fnMain");

    function fnChangeTipoFatorConversao(tipo) {
        $('form#fly01mdlfrmFatorConversao #tipoFatorconversao').val(tipo);
        calculaFatorConversao(tipo);
    }

    function calculaFatorConversao(tipo) {
        var quant = parseFloat(noComma($('form#fly01mdlfrmFatorConversao #quantidadeXml').val()));
        var valor = parseFloat(noComma($('form#fly01mdlfrmFatorConversao #valorXml').val()));
        var fator = parseFloat(noComma($('form#fly01mdlfrmFatorConversao #fatorConversao').val()));
        var totalXml = quant * valor;
        if (fator <= 0.0) {
            $$$.toast("Fator de conversão deve ser superior a zero.", 'error');
            return;
        }

        if (tipo == "Multiplicar") {
            var quantFinal = (quant * fator);
            $('form#fly01mdlfrmFatorConversao #quantidadeConvertida').val(quantFinal);
            $('form#fly01mdlfrmFatorConversao #valorConvertido').val(valor / quantFinal);
        }
        else {
            var quantFinal = (quant / fator);
            $('form#fly01mdlfrmFatorConversao #quantidadeConvertida').val(quantFinal);
            $('form#fly01mdlfrmFatorConversao #valorConvertido').val(valor * quantFinal);
        }
        $$$.fn.updateTextFields();
    }
</script>