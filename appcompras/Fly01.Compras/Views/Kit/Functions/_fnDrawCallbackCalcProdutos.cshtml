<script>
    function fnDrawCallbackCalcProdutos(oSettings) {
        this.hideEmptyColumns(this);
        $('#dtKitItens .fly01-dt-menu.dropdown-button').dropdown({ alignment: "right" });
        $('#dtKitItens select').material_select();
        if (oSettings._iDisplayLength >= oSettings.fnRecordsDisplay()) {
            $(oSettings.nTableWrapper).find(".dataTables_paginate").hide();
        }
        else {
            $(oSettings.nTableWrapper).find(".dataTables_paginate").show();
        }

        $('#dtKitItens tbody tr').each(function () {
            $(this).find("td").attr("nowrap", "nowrap");
        });

        if ($$$._.dtKitItens)
            $$$._.dtKitItens.columns.adjust();
        $('#dtKitItens').loading("stop");


        let valorCusto = 0;
        let valorServico = 0;
        let valorVenda = 0;

        $$$._.dtKitItens.data().each(function (value, index) {
            valorVenda = parseFloat(valorVenda.toString().replace(".", "").replace(",", ".")) + (value.valorVenda == null ? 0 : parseFloat(value.valorVenda.replace(".", "").replace(",", ".")));
            valorVenda = valorVenda * (value.valorVenda != null ? parseFloat(value.quantidade.toString().replace(".", "").replace(",", ".")) : 1);
            valorServico = parseFloat(valorServico.toString().replace(".", "").replace(",", ".")) + (value.valorServico == null ? 0 : parseFloat(value.valorServico.replace(".", "").replace(",", ".")));
            valorServico = valorServico * (value.valorServico != null ? parseFloat(value.quantidade.toString().replace(".", "").replace(",", ".")) : 1);
            valorCusto = parseFloat(valorCusto.toString().replace(".", "").replace(",", ".")) + (value.valorCusto == null ? 0 : parseFloat(value.valorCusto.replace(".", "").replace(",", ".")));
        });

        $('#valorVendaTotal').val(valorVenda);
        $('#valorServicoTotal').val(valorServico);
        $('#valorCustoTotal').val(valorCusto);


        $('#valorCustoTotal').on('click', function () {
            $("label[for='valorCustoTotal']").removeClass("truncate active");
        });

        $('#valorServicoTotal').on('click', function () {
            $("label[for='valorServicoTotal']").removeClass("truncate active");
        });

        $('#valorVendaTotal').on('click', function () {
            $("label[for='valorVendaTotal']").removeClass("truncate active");
        });
    }
</script>