<script>
    @Html.Partial("Functions/_fnMain");

    var arrItems = [];
    var qtdItensSelecionados = 0;

    $().ready(function () {
        $('#btnGerarArqRemessa').attr('disabled', 'disabled');
        setupGridSelectEvents();
    });

    function setupGridSelectEvents() {
        fly01._.dtBoletos.on("select", function (e, dt, type, indexes) {
            let indice = parseInt(indexes.toString());

            if (fly01._.dtBoletos.rows().data()[indice].statusDescription != "BAIXADO") {
                if (type !== undefined) {
                    indexes.forEach(function (element, index, array) {
                        fnAtualizaCountSelecionados(1);
                    });
                }
            }
            else {
                $(fly01._.dtBoletos.rows().$("tr")[indice]).removeClass('selected');
            }
        }).on('deselect', function (e, dt, type, indexes) {
            if (type !== undefined) {
                indexes.forEach(function (element, index, array) {
                    fnAtualizaCountSelecionados(-1);
                });
            }
        });
    }

    function fnAtualizaCountSelecionados(count) {
        var countAtual = qtdItensSelecionados;
        countAtual = countAtual + (parseInt(count));
        qtdItensSelecionados = countAtual;

        fly01.fn.updateTextFields();
        $('#btnGerarArqRemessa').attr('disabled', 'disabled');

        if (countAtual > 0 && countAtual <= 50) {
            $('#btnGerarArqRemessa').removeAttr('disabled');
        }
        else if (countAtual <= 0) {
            $('#btnGerarArqRemessa').attr('disabled', 'disabled');
        }
        else {
            $('#btnGerarArqRemessa').attr('disabled', 'disabled');
        }
    }
</script>