<script>
    function lockSaldos(elName, lock) {
        $("#" + elName).loading(lock ? "start" : "stop");
    }

    function fnGetSaldos(dataFinal, dataInicial) {
        $$$.loading.start();
        var final = isValidDate(dataFinal.toString()) ? dataFinal : formatDate(dataFinal);
        var inicio = isValidDate(dataInicial.toString()) ? dataInicial : formatDate(dataInicial);

        lockSaldos("fly01cardAB", true);
        lockSaldos("fly01cardAN", true);
        lockSaldos("fly01cardCO", true);
        lockSaldos("fly01cardCA", true);

        $.ajax({
            url: '@Url.Action("LoadCards", "Dashboard")' + '?dataFinal=' + final + "&dataInicial="+ inicio,
            type: "GET",
            success: function (data) {               
                $$$._.fly01cardAB.info(data.EmAberto);
                $$$._.fly01cardAN.info(data.EmAndamento);
                $$$._.fly01cardCO.info(data.Concluido);
                $$$._.fly01cardCA.info(data.Cancelado);

                lockSaldos("fly01cardAB", false);
                lockSaldos("fly01cardAN", false);
                lockSaldos("fly01cardCO", false);
                lockSaldos("fly01cardCA", false);
                $$$.loading.stop();
            },
            error: function (jXHR, textStatus) {
                $$$.toast(textStatus, 'error');
                $$$.loading.stop();
            }
        });
    }

    function formatDate(date) {
        var d = new Date(date),
            month = '' + (d.getMonth() + 1),
            day = '' + d.getDate(),
            year = d.getFullYear();

        if (month.length < 2) month = '0' + month;
        if (day.length < 2) day = '0' + day;

        return [year, month, day].join('-');
    }

    function isValidDate(dateString) {
        var regEx = /^\d{4}-\d{2}-\d{2}$/;
        return dateString.match(regEx) != null;
    }

</script>