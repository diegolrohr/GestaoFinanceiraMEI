<script>
    @Html.Partial("Functions/_fnMain");

    function fnGerarArquivoRemessa() {
        $("#dtBoletos").loading("start");
        $.ajax({
            type: "POST",
            url: '@Url.Action("GeraArquivoRemessa","Cnab")',
            data: { ids: fly01._.dtBoletos.selected },
            success: function (retorno) {
                if (retorno.FileGuid != null)
                    window.location = '@Url.Action("DownloadArquivoRemessa", "Cnab")?fileName=' + retorno.FileGuid;
                else
                    fly01.toast("Não foi possível baixar o arquivo, tente novamente mais tarde.", 'error');

                fly01._.dtBoletos.refresh();
                $("#dtBoletos").loading("stop");
                
            }
        });
    };
</script>