<script>
    @Html.Partial("Functions/_fnMain");

    function fnFormReady() {
        if ($("#grupoProdutoDescricao").data("url-post"))
            $("#grupoProdutoDescricao").data("url-post", "@Url.Action("NovoGrupoProduto")?tipo=" + $("#tipoProduto").val());

        if (isCreate()) {
            $("#saldoProdutoField").prop('disabled', false);
        } else {
            var saldoProduto = $("#saldoProduto").val();
            saldoProduto = parseFloat(saldoProduto).toLocaleString("pt-BR");
            $("#saldoProdutoField").val(saldoProduto);
            fnChangeSaldoProduto();
        }

        if ($('select#tipoProduto').val() == undefined || $('select#tipoProduto').val() == 'Servico') {
            $('select#tipoProduto').val('Outros');
            $('select#tipoProduto').material_select();
        }   

        if ($('input#ncmId').val() == "") {
            $('input#cestId').attr('disabled', 'disabled');;
            $('input#cestDescricao').attr('disabled', 'disabled');
        }
        setNFERequiredFields("fly01frm", ["descricao", "codigoBarras", "tipoProduto", "unidadeMedidaDescricao", "aliquotaIpi", "ncmDescricao", "cestDescricao", "valorVenda", "enquadramentoLegalIPIDescricao", "origemMercadoria", "extipi"]);

        $("#ncmDescricao").keyup(function () {
            $('input#cestId').attr('disabled', 'disabled');;
            $('input#cestDescricao').attr('disabled', 'disabled');
        })
        $("#ncmDescricao").keyup(function () {
            $('input#aliquotaIpi').attr('disabled', 'disabled');;
            $('input#aliquotaIpi').attr('disabled', 'disabled');
        })
        $("#ncmDescricao").keyup(function () {
            $('input#aliquotaIpi').val("");
        })
    }

    function isCreate() {
        var idSelector = "input#id";
        var id = $(idSelector).val();
        if (id.length == 0) return true;
        return false;
    }
</script>