<script>
    function fnImportarProdutoFormReady() {
        $$$._.cardDuvidas.info("Se preferir você pode baixar um arquivo modelo de importação.<br /><br />" +
                                 "Dicas:<br />" +
                                 "Você deve editar o modelo com o Notepad++ ou com o bloco de notas.<br />" +
                                 "Os dados contidos no arquivo são apenas exemplos, é preciso alterar o preenchimento com informações válidas.<br />" +
                                 "");
        $("#cardDuvidas h5").css({ "text-align": "left" });
        $("#observacao").closest("div").css("display", "none");
        $$$.fn.updateTextFields();

        $("#cardDuvidas a").on("click", function () {
            fnBaixarModelo();
        })
    }

    function fnBaixarModelo() {
        var documentoHelper = '"Descricao","CodigoProduto","CodigoBarras","AbreviacaoUnidadeMedida","SaldoMinimo","ValorCusto","ValorVenda","Observacao"\n';
        documentoHelper += '"Produto A","123","SEM GTIM","UN","10","50","10","Observação Produto A"\n';
        documentoHelper += '"Produto B","321","SEM GTIM","UN","10","50","10","Observação Produto B"\n';


        var blob = new Blob([documentoHelper], { type: 'text/csv;charset=utf-8;' });
        var filename = 'template.csv';

        if (window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveBlob(blob, filename);
        }
        else {
            var elem = window.document.createElement('a');
            elem.href = window.URL.createObjectURL(blob);
            elem.download = filename;
            document.body.appendChild(elem);
            elem.click();
            document.body.removeChild(elem);
        }
    }
</script>